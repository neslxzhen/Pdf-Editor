(this["webpackJsonppdf-editor"]=this["webpackJsonppdf-editor"]||[]).push([[0],{30:function(e,t,n){e.exports=n(45)},35:function(e,t,n){},36:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(10),i=n.n(c),o=(n(35),n(1)),s=n(2),u=(n(36),n(3)),l=n.n(u),d=n(5),f=[{name:"pdfjsLib",src:"https://unpkg.com/pdfjs-dist@2.3.200/build/pdf.min.js"},{name:"PDFLib",src:"https://unpkg.com/pdf-lib@1.4.0/dist/pdf-lib.min.js"},{name:"download",src:"https://unpkg.com/downloadjs@1.4.7"},{name:"w3Color",src:"https://www.w3schools.com/lib/w3color.js"}],p={},h=function(e){return p[e]},m={Courier:{correction:function(e,t){return(e*t-e)/2+e/6}},Helvetica:{correction:function(e,t){return(e*t-e)/2+e/10}},"Times-Roman":{correction:function(e,t){return(e*t-e)/2+e/7}}},g=(Object(o.a)(Object(o.a)({},m),{},{"\u6a19\u6977\u9ad4":{src:"/CK.ttf",correction:function(e,t){return(e*t-e)/2}}}),function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(){return t(a.result)},a.onerror=n,a.readAsArrayBuffer(e)}))}),b=function(e){return new Promise((function(t,n){var a=new Image;if(a.onload=function(){return t(a)},a.onerror=n,e instanceof Blob){var r=window.URL.createObjectURL(e);a.src=r}else a.src=e}))},v=function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(){return t(a.result)},a.onerror=n,a.readAsDataURL(e)}))},E=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("pdfjsLib");case 2:return n=e.sent,a=new Blob([t]),r=window.URL.createObjectURL(a),e.abrupt("return",n.getDocument(r).promise);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function x(e,t,n){return O.apply(this,arguments)}function O(){return(O=Object(d.a)(l.a.mark((function e(t,n,a){var r,c,i,o,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("PDFLib");case 2:return r=e.sent,e.next=5,h("download");case 5:return c=e.sent,e.prev=6,e.t0=r.PDFDocument,e.next=10,g(t);case 10:return e.t1=e.sent,e.next=13,e.t0.load.call(e.t0,e.t1);case 13:i=e.sent,e.next=20;break;case 16:throw e.prev=16,e.t2=e.catch(6),console.log("Failed to load PDF."),e.t2;case 20:return o=i.getPages().map(function(){var e=Object(d.a)(l.a.mark((function e(t,a){var r,c,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n[a],c=t.getHeight(),o=r.map(function(){var e=Object(d.a)(l.a.mark((function e(n){var a,r,o,s,u,d,f,p,h,m,b,v,E,x,O,y;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("image"!==n.type){e.next=29;break}if(r=(a=n).file,o=a.x,s=a.y,u=a.width,d=a.height,e.prev=2,"image/jpeg"!==r.type){e.next=13;break}return e.t0=i,e.next=7,g(r);case 7:return e.t1=e.sent,e.next=10,e.t0.embedJpg.call(e.t0,e.t1);case 10:f=e.sent,e.next=20;break;case 13:return e.t2=i,e.next=16,g(r);case 16:return e.t3=e.sent,e.next=19,e.t2.embedPng.call(e.t2,e.t3);case 19:f=e.sent;case 20:return e.abrupt("return",(function(){return t.drawImage(f,{x:o,y:c-s-d,width:u,height:d})}));case 23:throw e.prev=23,e.t4=e.catch(2),console.log("Failed to embed image.",e.t4),e.t4;case 27:e.next=35;break;case 29:if("text"!==n.type){e.next=35;break}return h=(p=n).x,m=p.y,b=p.text,v=p.lineHeight,E=p.size,x=p.fontFamily,O=p.width,e.next=33,i.embedFont(x);case 33:return y=e.sent,e.abrupt("return",(function(){return t.drawText(b,{maxWidth:O,font:y,size:E,lineHeight:v,x:h,y:c-E-m})}));case 35:case"end":return e.stop()}}),e,null,[[2,23]])})));return function(t){return e.apply(this,arguments)}}()),e.next=5,Promise.all(o);case 5:e.sent.forEach((function(e){return e()}));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=23,Promise.all(o);case 23:return e.prev=23,e.next=26,i.save();case 26:s=e.sent,c(s,a,"application/pdf"),e.next=34;break;case 30:throw e.prev=30,e.t3=e.catch(23),console.log("Failed to save PDF."),e.t3;case 34:case"end":return e.stop()}}),e,null,[[6,16],[23,30]])})))).apply(this,arguments)}var y,j=n(47),w=n(48),A=n(46),T=n(49),k=n(50),P=(n(38),n(11));!function(e){e.RESET="RESET",e.ADD_ATTACHMENT="ADD_ATTACHMENT",e.REMOVE_ATTACHMENT="REMOVE_ATTACHMENT",e.UPDATE_ATTACHMENT="UPDATE_ATTACHMENT",e.UPDATE_PAGE_INDEX="UPDATE_PAGE_INDEX"}(y||(y={}));var C,D,S,R,M={pageIndex:-1,allPageAttachments:[],pageAttachments:[]},N=function(e,t){var n=e.pageIndex,a=e.allPageAttachments,r=e.pageAttachments;switch(t.type){case y.ADD_ATTACHMENT:var c=a.map((function(e,a){return n===a?[].concat(Object(P.a)(e),[t.attachment]):e}));return Object(o.a)(Object(o.a)({},e),{},{allPageAttachments:c,pageAttachments:c[n]});case y.REMOVE_ATTACHMENT:var i=a.map((function(e,a){return n===a?r.filter((function(e){return e.id!==t.id})):e}));return Object(o.a)(Object(o.a)({},e),{},{allPageAttachments:i,pageAttachments:i[n]});case y.UPDATE_ATTACHMENT:if(-1===n)return e;var s=a.map((function(e,a){return n===a?r.map((function(e){return e.id===t.id?Object(o.a)(Object(o.a)({},e),t.attachment):e})):e}));return Object(o.a)(Object(o.a)({},e),{},{allPageAttachments:s,pageAttachments:s[n]});case y.UPDATE_PAGE_INDEX:return Object(o.a)(Object(o.a)({},e),{},{pageIndex:t.pageIndex,pageAttachments:a[t.pageIndex]});case y.RESET:return{pageIndex:0,pageAttachments:[],allPageAttachments:Array(t.numberOfPages).fill([])};default:return e}};!function(e){e.MOVE="MOVE",e.SCALE="SCALE",e.NO_MOVEMENT="NO_MOVEMENT"}(C||(C={})),function(e){e.RED="red",e.ORANGE="orange",e.YELLOW="yellow",e.OLIVE="olive",e.GREEN="green",e.TEAL="teal",e.BLUE="blue",e.VIOLOET="violet",e.PURPLE="purple",e.BROWN="brown",e.GREY="grey",e.BLACK="black"}(D||(D={})),function(e){e.IMAGE="image",e.TEXT="text"}(S||(S={})),function(e){e.INSERT="insert",e.COMMAND="command"}(R||(R={}));var I=n(9),F=Object(a.forwardRef)((function(e,t){var n=e.listeners,a=e.draggableAttrs,c=e.onBlur,i=e.onChangeText,s=e.editing,u=void 0!==s&&s,l=e.text,d=e.size,f=e.lineHeight,p=e.fontFamily,h=e.style,m=Object(o.a)(Object(o.a)({},n),a);return r.a.createElement("input",Object.assign({type:"text",onBlur:c,ref:t,onChange:i,readOnly:!u,style:Object(o.a)({fontSize:d,lineHeight:f,fontFamily:p,outline:"none",padding:0,margin:0,cursor:u?"text":"move",border:"unset",backgroundColor:"unset"},h),value:l,size:(null===l||void 0===l?void 0:l.length)||5},u?{}:m))})),H=function(e){var t=e.style,n=e.translateX,a=e.translateY,c=e.position,i=e.children;return r.a.createElement("div",{style:Object(o.a)(Object(o.a)({position:"absolute"},c),{},{width:"3rem",height:"3rem",margin:"auto",borderRadius:"9999px",transform:"translateX(".concat(n,") translateY(").concat(a,") rotate(0) skewX(0) skewY(0) scaleX(0.25) scaleY(0.25)")},t)},i)},_=n(21),L=function(e){var t=e.id,n=e.text,c=(e.pageHeight,e.pageWidth,e.removeText),i=e.updateTextAttachment,u=e.size,l=e.lineHeight,d=e.fontFamily,f=e.hidden,p=void 0!==f&&f,h=e.x,m=e.y,g=Object(a.useState)(n||""),b=Object(s.a)(g,2),v=b[0],E=b[1],x=Object(a.useState)(!1),O=Object(s.a)(x,2),y=O[0],j=O[1],w=Object(I.d)({id:t}),A=w.attributes,T=w.node,k=(w.isDragging,w.listeners),P=w.setNodeRef;Object(a.useEffect)((function(){if(y){var e=T.current;e&&(e.focus(),e.select())}else{var t;if(null===(t=document.getSelection())||void 0===t||t.removeAllRanges(),""===v&&c)c();else if(i){i({lines:[v],text:v})}}}),[y]);var C=r.a.createElement(H,{position:{top:0,right:0},translateX:"50%",translateY:"-50%",style:{cursor:"pointer",backgroundColor:"#1eb99d"}},r.a.createElement(_.d,{onClick:function(){j(!0)},style:{color:"white",width:"100%",height:"100%"}})),D={borderWidth:"0.3px",borderColor:"gray",borderStyle:y?"solid":"dashed"},S=p?{visibility:"hidden"}:{};return r.a.createElement("div",{style:Object(o.a)({position:"absolute",left:"".concat(null!==h&&void 0!==h?h:0,"px"),top:"".concat(null!==m&&void 0!==m?m:0,"px")},S)},y&&c&&i?null:C,r.a.createElement(F,{ref:P,listeners:k,draggableAttrs:A,onBlur:function(e){j(!1)},text:v,size:u,lineHeight:l,fontFamily:d,editing:y,onChangeText:function(e){var t=e.currentTarget.value;E(t)},style:D}))},X=Object(a.forwardRef)((function(e,t){var n=e.width,a=e.height,c=e.img,i=e.style,s=e.listeners,u=e.draggableAttrs,l=e.desc;return r.a.createElement("img",Object.assign({style:Object(o.a)({width:n+"px",height:a+"px",cursor:"move"},i),src:c.src,ref:t},s,u,{alt:l}))})),U=function(e){var t=e.id,n=e.img,a=e.width,c=e.height,i=(e.pageWidth,e.removeImage),s=(e.pageHeight,e.hidden),u=void 0!==s&&s,l=e.x,d=e.y,f=Object(I.d)({id:t}),p=f.attributes,h=(f.isDragging,f.listeners),m=f.setNodeRef,g=r.a.createElement(H,{position:{left:0,top:0,right:0},translateX:"0",translateY:"-50%",style:{backgroundColor:"white"}},r.a.createElement(_.e,{onClick:i,style:{cursor:"pointer",color:"rgb(245, 101, 101)",width:"100%",height:"100%"}})),b=r.a.createElement(_.c,{style:{color:"#90cdf4",width:"100%",height:"100%"}}),v=r.a.createElement(H,{position:{left:0,top:0},translateX:"-50%",translateY:"-50%"},b),E=r.a.createElement(H,{position:{right:0,top:0},translateX:"50%",translateY:"-50%"},b),x=r.a.createElement(H,{position:{left:0,bottom:0},translateX:"-50%",translateY:"50%"},b),O=r.a.createElement(H,{position:{right:0,bottom:0},translateX:"50%",translateY:"50%"},b),y=u?{visibility:"hidden"}:{};return r.a.createElement("div",{style:Object(o.a)({position:"absolute",left:"".concat(null!==l&&void 0!==l?l:0,"px"),top:"".concat(null!==d&&void 0!==d?d:0,"px")},y)},i&&g,v,E,x,O,r.a.createElement(X,{ref:m,listeners:h,draggableAttrs:p,style:{border:"0.3px dashed gray",cursor:"move"},img:n,width:a,height:c}))};function z(e){var t=e.children,n=e.id,a=e.x,c=e.y,i=e.width,s=e.height,u=Object(I.e)({id:n}),l=u.isOver,d=u.setNodeRef,f={color:"gray",borderStyle:"dashed",borderWidth:"1px"};return l&&(f={boxShadow:"inset #1eb99d 0 0 0 3px, rgba(201, 211, 219, 0.5) 20px 14px 24px"}),t&&(f={color:"rgb(245, 101, 101)",borderStyle:"solid"}),r.a.createElement("div",{ref:d,style:Object(o.a)({width:i,height:s,position:"absolute",left:"".concat(null!==a&&void 0!==a?a:0,"px"),top:"".concat(null!==c&&void 0!==c?c:0,"px")},f)},t)}var G=function(e){var t=e.placements,n=e.attachments,a=e.scale,c=void 0===a?1:a;return r.a.createElement(r.a.Fragment,null,t.map((function(e){var t=e.id;return r.a.createElement(z,Object.assign({key:t},e,{width:e.width*c,height:e.height*c,x:e.x*c,y:e.y*c}),function(e){var t=e.map((function(e){var t=e.id;return r.a.createElement("div",{hidden:!0,key:t})}));return t.length?t:null}(null===n||void 0===n?void 0:n.filter((function(e){return e.column_id===t}))))})))},Y=function(e){var t=e.placements,n=e.attachments,i=e.pageDimensions,o=e.removeAttachment,u=e.updateAttachment,l=e.scale,d=Object(a.useState)(I.c),f=Object(s.a)(d,2),p=f[0],h=f[1],m=Object(a.useState)(null),g=Object(s.a)(m,2),b=g[0],v=g[1],E=Object(a.useState)(null),x=Object(s.a)(E,2),O=x[0],y=x[1],j=Object(a.useState)(null),w=Object(s.a)(j,2),A=w[0],T=w[1];Object(a.useEffect)((function(){if(O){var e=n.find((function(e){return e.id===O}))||null,t=null;(null===e||void 0===e?void 0:e.type)===S.TEXT?t=r.a.createElement(F,e):(null===e||void 0===e?void 0:e.type)===S.IMAGE&&(t=r.a.createElement(X,e)),v(e),T(t)}}),[O]);var k=function(e){return function(t){return u(e,t)}};return console.log(t),r.a.createElement(I.a,{onDragStart:function(e){y(e.active.id),h({x:window.scrollX,y:window.scrollY})},onDragEnd:function(e){var n={};if(e.over){var a=e.over.id,r=t.find((function(e){return e.id===a}));n={x:r.x*(l||1),y:r.y*(l||1),column_id:a}}else n={x:e.delta.x+((null===b||void 0===b?void 0:b.x)||0)-p.x,y:e.delta.y+((null===b||void 0===b?void 0:b.y)||0)-p.y,column_id:null};u(e.active.id,n),y("")},onDragCancel:function(){return y("")}},r.a.createElement(G,{placements:t,attachments:n,scale:l}),n.map((function(e){return function(e,t){return e.type===S.IMAGE?r.a.createElement(U,Object.assign({key:t,hidden:O===e.id,pageWidth:i.width,pageHeight:i.height,removeImage:function(){return o(e.id)},updateImageAttachment:k(e.id)},e)):r.a.createElement(L,Object.assign({key:t,hidden:O===e.id,pageWidth:i.width,pageHeight:i.height,removeText:function(){return o(e.id)},updateTextAttachment:k(e.id)},e))}(e,e.id)})),Object(c.createPortal)(r.a.createElement(I.b,null,A),document.body))},B=n(16),V=n.n(B);function W(e){return J.apply(this,arguments)}function J(){return(J=Object(d.a)(l.a.mark((function e(t){var n,a,r,c,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v(t);case 3:return n=e.sent,e.next=6,b(n);case 6:return a=e.sent,r=V.a.v4(),c=a.width,i=a.height,o={id:r,type:S.IMAGE,width:c,height:i,x:0,y:0,img:a,file:t},e.abrupt("return",o);case 13:throw e.prev=13,e.t0=e.catch(0),console.log("Failed to load image",e.t0),new Error("Failed to load image");case 17:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}var K=function(e,t,n){var a=1;return e>n&&(a=n/e),t>n&&(a=Math.min(a,n/t)),{width:e*a,height:t*a}},$=function(e){var t=e.children,n=e.onClick,a=e.style;return r.a.createElement("div",{onClick:n,style:Object(o.a)({margin:"0.5rem",float:"left"},a)},t)},q=function(e){var t=e.attachment,n=e.addAttachment,a=e.scale,c=void 0===a?1:a;return r.a.createElement($,{onClick:function(e){n&&n(Object(o.a)(Object(o.a)({},t),{},{id:V.a.v4()}))}},r.a.createElement(X,Object.assign({},function(e){var t=K(e.width,e.height,80),n=t.width,a=t.height;return Object(o.a)(Object(o.a)({},e),{},{x:e.x*c,y:e.y*c,width:n*c,height:a*c})}(t),{style:{cursor:"pointer"}})))},Q=n(28),Z=Object(Q.a)("MY_DB",2,{upgrade:function(e,t,n,a){e.createObjectStore("images")},blocked:function(){},blocking:function(){},terminated:function(){}});function ee(e,t){return te.apply(this,arguments)}function te(){return(te=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z;case 2:return a=e.sent,e.next=5,a.put("images",t,n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(){return ae.apply(this,arguments)}function ae(){return(ae=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z;case 2:return t=e.sent,e.next=5,t.getAll("images");case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re=function(){for(var e=[],t=0;t<5;t++)for(var n=0;n<4;n++)e.push({height:50,width:91,x:103+91*t,y:470+50*n,id:"".concat(t,"-").concat(n)});return e},ce=function(e){var t=e.page,n=e.dimensions,c=e.setDimensions,i=e.scale,o=void 0===i?1:i,u=Object(a.useRef)(null),f=Object(a.useState)((null===n||void 0===n?void 0:n.width)||0),p=Object(s.a)(f,2),h=p[0],m=p[1],g=Object(a.useState)((null===n||void 0===n?void 0:n.height)||0),b=Object(s.a)(g,2),v=b[0],E=b[1];return Object(a.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var n,a,r,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(n=e.sent,a=u.current,!n){e.next=14;break}if(r=null===a||void 0===a?void 0:a.getContext("2d"),i=n.getViewport({scale:o}),m(i.width),E(i.height),!r){e.next=14;break}return e.next=12,n.render({canvasContext:null===a||void 0===a?void 0:a.getContext("2d"),viewport:i}).promise;case 12:s={width:i.width,height:i.height},c&&c(s);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,c]),r.a.createElement("div",null,r.a.createElement("canvas",{ref:u,width:h,height:v}))},ie=n(51),oe=function(e){var t=e.currentPage,n=e.dimensions,a=e.setDimensions,c=e.children,i=e.scale;return r.a.createElement(ie.a,{style:{display:"table"}},r.a.createElement(ce,{dimensions:n,setDimensions:a,page:t,scale:i}),c)},se=function(e){var t=e.onClick,n=e.children;e.scale;return r.a.createElement($,null,r.a.createElement(A.a,{style:{width:"100%",height:"5rem"},onClick:t},n))},ue=function(){var e=Object(a.useState)(1.65),t=Object(s.a)(e,2),n=t[0],c=(t[1],function(){var e=Object(a.useState)(""),t=Object(s.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(-1),i=Object(s.a)(c,2),o=i[0],u=i[1],f=Object(a.useState)(),p=Object(s.a)(f,2),h=p[0],m=p[1],g=Object(a.useState)(),b=Object(s.a)(g,2),v=b[0],E=b[1],O=Object(a.useState)([]),y=Object(s.a)(O,2),j=y[0],w=y[1],A=Object(a.useState)(!1),T=Object(s.a)(A,2),k=T[0],P=T[1],C=Object(a.useState)(!1),D=Object(s.a)(C,2),S=D[0],R=D[1],M=Object(a.useState)(!1),N=Object(s.a)(M,2),I=N[0],F=N[1],H=Object(a.useState)(!1),_=Object(s.a)(H,2),L=_[0],X=_[1],U=Object(a.useCallback)(m,[m]);return{isMultiPage:k,isFirstPage:S,isLastPage:I,isSaving:L,currentPage:j[o],dimensions:h,setDimensions:U,name:n,setName:r,pageIndex:o,setPageIndex:u,file:v,setFile:E,pages:j,nextPage:function(){var e=o+1;u(o+1),R(0===e),F(e===j.length-1)},savePdf:function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!L&&v){e.next=2;break}return e.abrupt("return");case 2:return X(!0),e.prev=3,e.next=6,x(v,t,n);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),console.log(e.t0);case 11:return e.prev=11,X(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[3,8,11,14]])})));return function(t){return e.apply(this,arguments)}}(),setPdf:function(e){var t=e.name,n=e.file,a=e.pages,c=a.length>1;r(t),E(n),w(a),u(0),P(c),R(!0),F(1===a.length)},previousPage:function(){var e=o-1;u(e),R(0===e),F(e===j.length-1)}}}()),i=c.file,u=c.setPdf,f=c.pageIndex,p=c.isMultiPage,h=c.isFirstPage,m=c.isLastPage,g=c.currentPage,b=(c.isSaving,c.savePdf),v=c.previousPage,O=c.nextPage,P=c.setDimensions,C=(c.name,c.dimensions),D=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne();case 2:return t=e.sent,e.next=5,Promise.all(t.map(function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:n=e.sent,r(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),{allAttachment:n,setAllAttachment:r,save:function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee(t.file,t.id);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}(),R=D.save,I=D.allAttachment,F=(D.setAllAttachment,function(){var e=Object(a.useReducer)(N,M),t=Object(s.a)(e,2),n=t[0],r=t[1],c=n.allPageAttachments;return{pageAttachments:n.pageAttachments,allPageAttachments:c,add:function(e){return r({type:y.ADD_ATTACHMENT,attachment:e})},reset:function(e){return r({type:y.RESET,numberOfPages:e})},remove:function(e){return r({type:y.REMOVE_ATTACHMENT,id:e})},update:function(e,t){return r({type:y.UPDATE_ATTACHMENT,id:e,attachment:t})},setPageIndex:Object(a.useCallback)((function(e){return r({type:y.UPDATE_PAGE_INDEX,pageIndex:e})}),[r])}}()),H=F.add,L=F.allPageAttachments,X=F.pageAttachments,U=F.reset,z=F.update,G=F.remove,B=F.setPageIndex,J=!!i,$=function(e){var t=e.after,n=Object(a.useState)(!1),r=Object(s.a)(n,2),c=r[0],i=r[1],o=Object(a.createRef)();return{inputRef:o,uploading:c,handleClick:function(){var e=o.current;e&&(e.value="",i(!0),e.click())},fileOnChange:function(){var e=Object(d.a)(l.a.mark((function e(n){var a,r,o,s,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=function(){return(u=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E(t);case 3:return n=e.sent,e.abrupt("return",{file:t,name:t.name,pages:Array(n.numPages).fill(0).map((function(e,t){return n.getPage(t+1)}))});case 7:throw e.prev=7,e.t0=e.catch(0),console.log("Failed to load pdf",e.t0),new Error("Failed to load PDF");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)},s=function(e){return u.apply(this,arguments)},c){e.next=4;break}return e.abrupt("return");case 4:if(a=n.currentTarget.files||n.dataTransfer&&n.dataTransfer.files){e.next=8;break}return i(!1),e.abrupt("return");case 8:return r=a[0],e.next=11,s(r);case 11:o=e.sent,t&&t(o),i(!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}({after:function(e){u(e);var t=e.pages.length;U(t)}}),Q=$.inputRef,Z=($.uploading,$.handleClick),te=$.fileOnChange,ae=function(e){var t=e.afterUploadAttachment,n=Object(a.useState)(!1),r=Object(s.a)(n,2),c=r[0],i=r[1],o=Object(a.createRef)();return{inputRef:o,uploading:c,handleClick:function(){var e=o.current;e&&(e.value="",i(!0),e.click())},fileOnChange:function(){var e=Object(d.a)(l.a.mark((function e(n){var a,r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=2;break}return e.abrupt("return");case 2:if(a=n.currentTarget.files||n.dataTransfer&&n.dataTransfer.files){e.next=6;break}return i(!1),e.abrupt("return");case 6:return r=a[0],e.next=9,W(r);case 9:o=e.sent,t&&(console.log("===> was this also called"),t(o)),i(!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}({afterUploadAttachment:function(e){R(e).then(),le(e)}}),ce=ae.inputRef,ie=(ae.uploading,ae.handleClick),ue=ae.fileOnChange;Object(a.useEffect)((function(){return B(f)}),[f,B]);var le=function(e){H(function(e){e.type===S.TEXT?e=function(e){return Object(o.a)(Object(o.a)({},e),{},{x:e.x*n,y:e.y*n,width:e.width*n,height:e.height*n,size:e.size?e.size*n:void 0})}(e):e.type===S.IMAGE&&(e=function(e){var t=K(e.width,e.height,80),a=t.width,r=t.height;return Object(o.a)(Object(o.a)({},e),{},{x:e.x*n,y:e.y*n,width:a*n,height:r*n})}(e));return e}(e))};function de(e){return e.map((function(e){return e.map((function(e){return function(e){e.type===S.TEXT?e=function(e){return Object(o.a)(Object(o.a)({},e),{},{x:e.x/n,y:e.y/n,width:e.width/n,height:e.height/n,size:e.size?e.size/n:void 0})}(e):e.type===S.IMAGE&&(e=function(e){return Object(o.a)(Object(o.a)({},e),{},{x:e.x/n,y:e.y/n,width:e.width/n,height:e.height/n})}(e));return e}(e)}))}))}var fe=r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{ref:Q,type:"file",accept:"application/pdf",onChange:te,style:{display:"none"}}),r.a.createElement("input",{ref:ce,type:"file",accept:"image/*",style:{display:"none"},onChange:ue})),pe={};p&&!h||(pe={visibility:"hidden"});var he={};return p&&!m||(he={visibility:"hidden"}),r.a.createElement("div",{className:"App"},fe,r.a.createElement(j.a,{fluid:!0},r.a.createElement("div",{style:{marginTop:"10px"}},!J&&r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{className:"justify-content-center mt-lg-5"},r.a.createElement("div",null,r.a.createElement("h3",null,"\u4e0a\u50b3\u4e00\u4efd Pdf\uff01"),r.a.createElement(A.a,{onClick:Z},"Upload")))),r.a.createElement(w.a,null,r.a.createElement(T.a,{sm:3},J&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"\u52a0\u5165\u9644\u4ef6"),r.a.createElement("p",null,"\u9019\u4e9b\u5716\u7247\u88ab\u5132\u5b58\u5728 local \u7684 IndexedDB"),r.a.createElement(se,{scale:n,onClick:function(){var e={id:V.a.v4(),type:S.TEXT,x:0,y:0,width:120,height:25,size:16,lineHeight:1.4,fontFamily:"Times-Roman",text:"Enter Text Here"};le(e)}},"\u65b0\u589e\u6587\u5b57"),I.filter((function(e){return e.type===S.IMAGE})).map((function(e){return r.a.createElement(q,{key:e.id,attachment:e,addAttachment:le,scale:n})})),r.a.createElement(se,{scale:n,onClick:ie},"\u4e0a\u50b3\u5716\u7247"))),r.a.createElement(T.a,{sm:9},r.a.createElement("div",{className:"pt-2 pb-2 d-flex justify-content-between",style:{width:(null===C||void 0===C?void 0:C.width)||0}},r.a.createElement("div",null,r.a.createElement(A.a,{style:pe,className:"rounded-circle",variant:"outline-dark",onClick:v},r.a.createElement(_.a,null))),r.a.createElement("div",null,J&&r.a.createElement(k.a,{className:"justify-content-center"},r.a.createElement(k.a.Link,{onClick:Z},"Upload New"),r.a.createElement(k.a.Link,{onClick:function(){return b(de(L))}},"Save"))),r.a.createElement("div",null,r.a.createElement(A.a,{style:he,className:"rounded-circle",variant:"outline-dark",onClick:O},r.a.createElement(_.b,null)))),g&&r.a.createElement(oe,{currentPage:g,dimensions:C,setDimensions:P,scale:n},C&&r.a.createElement(Y,{removeAttachment:G,updateAttachment:z,pageDimensions:C,attachments:X,placements:re(),scale:n})))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));f.forEach((function(e){var t=e.name,n=e.src;p[t]=new Promise((function(e,a){var r=document.createElement("script");r.src=n,r.onload=function(){e(window[t]),console.log("".concat(t," is loaded."))},r.onerror=function(){return a("The script ".concat(t," didn't load correctly."))},document.body.appendChild(r)}))})),i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ue,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[30,1,2]]]);
//# sourceMappingURL=main.a4fc3027.chunk.js.map