(this["webpackJsonppdf-editor"]=this["webpackJsonppdf-editor"]||[]).push([[0],{30:function(e,t,n){e.exports=n(45)},35:function(e,t,n){},36:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(10),i=n.n(c),o=(n(35),n(1)),s=n(2),l=(n(36),n(3)),u=n.n(l),d=n(5),f=[{name:"pdfjsLib",src:"https://unpkg.com/pdfjs-dist@2.3.200/build/pdf.min.js"},{name:"PDFLib",src:"https://unpkg.com/pdf-lib@1.4.0/dist/pdf-lib.min.js"},{name:"download",src:"https://unpkg.com/downloadjs@1.4.7"},{name:"w3Color",src:"https://www.w3schools.com/lib/w3color.js"}],p={},h=function(e){return p[e]},m={Courier:{correction:function(e,t){return(e*t-e)/2+e/6}},Helvetica:{correction:function(e,t){return(e*t-e)/2+e/10}},"Times-Roman":{correction:function(e,t){return(e*t-e)/2+e/7}}},g=(Object(o.a)(Object(o.a)({},m),{},{"\u6a19\u6977\u9ad4":{src:"/CK.ttf",correction:function(e,t){return(e*t-e)/2}}}),function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(){return t(a.result)},a.onerror=n,a.readAsArrayBuffer(e)}))}),b=function(e){return new Promise((function(t,n){var a=new Image;if(a.onload=function(){return t(a)},a.onerror=n,e instanceof Blob){var r=window.URL.createObjectURL(e);a.src=r}else a.src=e}))},v=function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(){return t(a.result)},a.onerror=n,a.readAsDataURL(e)}))},E=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("pdfjsLib");case 2:return n=e.sent,a=new Blob([t]),r=window.URL.createObjectURL(a),e.abrupt("return",n.getDocument(r).promise);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function x(e,t,n){return O.apply(this,arguments)}function O(){return(O=Object(d.a)(u.a.mark((function e(t,n,a){var r,c,i,o,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("PDFLib");case 2:return r=e.sent,e.next=5,h("download");case 5:return c=e.sent,e.prev=6,e.t0=r.PDFDocument,e.next=10,g(t);case 10:return e.t1=e.sent,e.next=13,e.t0.load.call(e.t0,e.t1);case 13:i=e.sent,e.next=20;break;case 16:throw e.prev=16,e.t2=e.catch(6),console.log("Failed to load PDF."),e.t2;case 20:return o=i.getPages().map(function(){var e=Object(d.a)(u.a.mark((function e(t,a){var r,c,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n[a],c=t.getHeight(),o=r.map(function(){var e=Object(d.a)(u.a.mark((function e(n){var a,r,o,s,l,d,f,p,h,m,b,v,E,x,O,y;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("image"!==n.type){e.next=29;break}if(r=(a=n).file,o=a.x,s=a.y,l=a.width,d=a.height,e.prev=2,"image/jpeg"!==r.type){e.next=13;break}return e.t0=i,e.next=7,g(r);case 7:return e.t1=e.sent,e.next=10,e.t0.embedJpg.call(e.t0,e.t1);case 10:f=e.sent,e.next=20;break;case 13:return e.t2=i,e.next=16,g(r);case 16:return e.t3=e.sent,e.next=19,e.t2.embedPng.call(e.t2,e.t3);case 19:f=e.sent;case 20:return e.abrupt("return",(function(){return t.drawImage(f,{x:o,y:c-s-d,width:l,height:d})}));case 23:throw e.prev=23,e.t4=e.catch(2),console.log("Failed to embed image.",e.t4),e.t4;case 27:e.next=35;break;case 29:if("text"!==n.type){e.next=35;break}return h=(p=n).x,m=p.y,b=p.text,v=p.lineHeight,E=p.size,x=p.fontFamily,O=p.width,e.next=33,i.embedFont(x);case 33:return y=e.sent,e.abrupt("return",(function(){return t.drawText(b,{maxWidth:O,font:y,size:E,lineHeight:v,x:h,y:c-E-m})}));case 35:case"end":return e.stop()}}),e,null,[[2,23]])})));return function(t){return e.apply(this,arguments)}}()),e.next=5,Promise.all(o);case 5:e.sent.forEach((function(e){return e()}));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=23,Promise.all(o);case 23:return e.prev=23,e.next=26,i.save();case 26:s=e.sent,c(s,a,"application/pdf"),e.next=34;break;case 30:throw e.prev=30,e.t3=e.catch(23),console.log("Failed to save PDF."),e.t3;case 34:case"end":return e.stop()}}),e,null,[[6,16],[23,30]])})))).apply(this,arguments)}var y,w=n(47),j=n(48),A=n(46),T=n(49),k=n(50),P=(n(38),n(11));!function(e){e.RESET="RESET",e.ADD_ATTACHMENT="ADD_ATTACHMENT",e.REMOVE_ATTACHMENT="REMOVE_ATTACHMENT",e.UPDATE_ATTACHMENT="UPDATE_ATTACHMENT",e.UPDATE_PAGE_INDEX="UPDATE_PAGE_INDEX"}(y||(y={}));var C,D,I,S,M={pageIndex:-1,allPageAttachments:[],pageAttachments:[]},F=function(e,t){var n=e.pageIndex,a=e.allPageAttachments,r=e.pageAttachments;switch(t.type){case y.ADD_ATTACHMENT:var c=a.map((function(e,a){return n===a?[].concat(Object(P.a)(e),[t.attachment]):e}));return Object(o.a)(Object(o.a)({},e),{},{allPageAttachments:c,pageAttachments:c[n]});case y.REMOVE_ATTACHMENT:var i=a.map((function(e,a){return n===a?r.filter((function(e){return e.id!==t.id})):e}));return Object(o.a)(Object(o.a)({},e),{},{allPageAttachments:i,pageAttachments:i[n]});case y.UPDATE_ATTACHMENT:if(-1===n)return e;var s=a.map((function(e,a){return n===a?r.map((function(e){return e.id===t.id?Object(o.a)(Object(o.a)({},e),t.attachment):e})):e}));return Object(o.a)(Object(o.a)({},e),{},{allPageAttachments:s,pageAttachments:s[n]});case y.UPDATE_PAGE_INDEX:return Object(o.a)(Object(o.a)({},e),{},{pageIndex:t.pageIndex,pageAttachments:a[t.pageIndex]});case y.RESET:return{pageIndex:0,pageAttachments:[],allPageAttachments:Array(t.numberOfPages).fill([])};default:return e}};!function(e){e.MOVE="MOVE",e.SCALE="SCALE",e.NO_MOVEMENT="NO_MOVEMENT"}(C||(C={})),function(e){e.RED="red",e.ORANGE="orange",e.YELLOW="yellow",e.OLIVE="olive",e.GREEN="green",e.TEAL="teal",e.BLUE="blue",e.VIOLOET="violet",e.PURPLE="purple",e.BROWN="brown",e.GREY="grey",e.BLACK="black"}(D||(D={})),function(e){e.IMAGE="image",e.TEXT="text"}(I||(I={})),function(e){e.INSERT="insert",e.COMMAND="command"}(S||(S={}));var R=n(9),N=Object(a.forwardRef)((function(e,t){var n=e.listeners,a=e.draggableAttrs,c=e.onBlur,i=e.onChangeText,s=e.editing,l=void 0!==s&&s,u=e.text,d=e.size,f=e.lineHeight,p=e.fontFamily,h=e.style,m=Object(o.a)(Object(o.a)({},n),a);return r.a.createElement("input",Object.assign({type:"text",onBlur:c,ref:t,onChange:i,readOnly:!l,style:Object(o.a)({fontSize:d,lineHeight:f,fontFamily:p,outline:"none",padding:0,margin:0,cursor:l?"text":"move",border:"unset",backgroundColor:"unset"},h),value:u,size:(null===u||void 0===u?void 0:u.length)||5},l?{}:m))})),H=function(e){var t=e.style,n=e.translateX,a=e.translateY,c=e.position,i=e.children;return r.a.createElement("div",{style:Object(o.a)(Object(o.a)({position:"absolute"},c),{},{width:"3rem",height:"3rem",margin:"auto",borderRadius:"9999px",transform:"translateX(".concat(n,") translateY(").concat(a,") rotate(0) skewX(0) skewY(0) scaleX(0.25) scaleY(0.25)")},t)},i)},_=n(18),U=function(e){var t=e.id,n=e.text,c=(e.pageHeight,e.pageWidth,e.removeText),i=e.updateTextAttachment,l=e.size,u=e.lineHeight,d=e.fontFamily,f=e.hidden,p=void 0!==f&&f,h=e.x,m=e.y,g=Object(a.useState)(n||""),b=Object(s.a)(g,2),v=b[0],E=b[1],x=Object(a.useState)(!1),O=Object(s.a)(x,2),y=O[0],w=O[1],j=Object(R.e)({id:t}),A=j.attributes,T=j.node,k=(j.isDragging,j.listeners),P=j.setNodeRef;Object(a.useEffect)((function(){if(y){var e=T.current;e&&(e.focus(),e.select())}else{var t;if(null===(t=document.getSelection())||void 0===t||t.removeAllRanges(),""===v&&c)c();else if(i){i({lines:[v],text:v})}}}),[y]);var C=function(){w(!1)},D=r.a.createElement(H,{position:{left:0,top:0,right:0},translateX:"0",translateY:"-50%",style:{backgroundColor:"white"}},r.a.createElement(_.c,{onClick:C,style:{cursor:"pointer",color:"#1eb99d",width:"100%",height:"100%"}})),I=r.a.createElement(H,{position:{left:0,top:0,right:0},translateX:"0",translateY:"-50%",style:{backgroundColor:"white"}},r.a.createElement(_.g,{onClick:c,style:{cursor:"pointer",color:"rgb(245, 101, 101)",width:"100%",height:"100%"}})),S={borderWidth:"0.3px",borderColor:"gray",borderStyle:y?"solid":"dashed"},M=p?{visibility:"hidden"}:{};return r.a.createElement("div",{style:Object(o.a)({position:"absolute",left:"".concat(null!==h&&void 0!==h?h:0,"px"),top:"".concat(null!==m&&void 0!==m?m:0,"px")},M),onDoubleClick:function(){w(!0)}},y?D:I,r.a.createElement(N,{ref:P,listeners:k,draggableAttrs:A,onBlur:C,text:v,size:l,lineHeight:u,fontFamily:d,editing:y,onChangeText:function(e){var t=e.currentTarget.value;E(t)},style:S}))},L=Object(a.forwardRef)((function(e,t){var n=e.width,a=e.height,c=e.img,i=e.style,s=e.listeners,l=e.draggableAttrs,u=e.desc;return r.a.createElement("img",Object.assign({style:Object(o.a)({width:n+"px",height:a+"px",cursor:"move"},i),src:c.src,ref:t},s,l,{alt:u}))})),X=function(e){var t=e.id,n=e.img,a=e.width,c=e.height,i=(e.pageWidth,e.removeImage),s=(e.pageHeight,e.hidden),l=void 0!==s&&s,u=e.x,d=e.y,f=Object(R.e)({id:t}),p=f.attributes,h=(f.isDragging,f.listeners),m=f.setNodeRef,g=r.a.createElement(H,{position:{left:0,top:0,right:0},translateX:"0",translateY:"-50%",style:{backgroundColor:"white"}},r.a.createElement(_.g,{onClick:i,style:{cursor:"pointer",color:"rgb(245, 101, 101)",width:"100%",height:"100%"}})),b=r.a.createElement(_.d,{style:{color:"#90cdf4",width:"100%",height:"100%"}}),v=r.a.createElement(H,{position:{left:0,top:0},translateX:"-50%",translateY:"-50%"},b),E=r.a.createElement(H,{position:{right:0,top:0},translateX:"50%",translateY:"-50%"},b),x=r.a.createElement(H,{position:{left:0,bottom:0},translateX:"-50%",translateY:"50%"},b),O=r.a.createElement(H,{position:{right:0,bottom:0},translateX:"50%",translateY:"50%"},b),y=l?{visibility:"hidden"}:{};return r.a.createElement("div",{style:Object(o.a)({position:"absolute",left:"".concat(null!==u&&void 0!==u?u:0,"px"),top:"".concat(null!==d&&void 0!==d?d:0,"px")},y)},i&&g,v,E,x,O,r.a.createElement(L,{ref:m,listeners:h,draggableAttrs:p,style:{border:"0.3px dashed gray",cursor:"move"},img:n,width:a,height:c}))};function G(e){var t=e.children,n=e.id,a=e.x,c=e.y,i=e.width,s=e.height,l=Object(R.f)({id:n}),u=l.isOver,d=l.setNodeRef,f={color:"gray",borderStyle:"dashed",borderWidth:"1px"};return u&&(f={boxShadow:"inset #1eb99d 0 0 0 3px, rgba(201, 211, 219, 0.5) 20px 14px 24px"}),t&&(f={color:"rgb(245, 101, 101)",borderStyle:"solid"}),r.a.createElement("div",{ref:d,style:Object(o.a)({width:i,height:s,position:"absolute",left:"".concat(null!==a&&void 0!==a?a:0,"px"),top:"".concat(null!==c&&void 0!==c?c:0,"px")},f)},t)}var Y,z=function(e){var t=e.placements,n=e.attachments,a=e.scale,c=void 0===a?1:a;return r.a.createElement(r.a.Fragment,null,t.map((function(e){var t=e.id;return r.a.createElement(G,Object.assign({key:t},e,{width:e.width*c,height:e.height*c,x:e.x*c,y:e.y*c}),function(e){var t=e.map((function(e){var t=e.id;return r.a.createElement("div",{hidden:!0,key:t})}));return t.length?t:null}(null===n||void 0===n?void 0:n.filter((function(e){return e.column_id===t}))))})))},B=function(e){var t=e.placements,n=e.attachments,i=e.pageDimensions,o=e.removeAttachment,l=e.updateAttachment,u=e.scale,d=Object(a.useState)(R.d),f=Object(s.a)(d,2),p=f[0],h=f[1],m=Object(a.useState)(null),g=Object(s.a)(m,2),b=g[0],v=g[1],E=Object(a.useState)(null),x=Object(s.a)(E,2),O=x[0],y=x[1],w=Object(a.useState)(null),j=Object(s.a)(w,2),A=j[0],T=j[1],k=Object(R.g)(R.c,{activationConstraint:{distance:1}});Object(a.useEffect)((function(){if(O){var e=n.find((function(e){return e.id===O}))||null,t=null;(null===e||void 0===e?void 0:e.type)===I.TEXT?t=r.a.createElement(N,e):(null===e||void 0===e?void 0:e.type)===I.IMAGE&&(t=r.a.createElement(L,e)),v(e),T(t)}}),[O]);var P=function(e){return function(t){return l(e,t)}};return r.a.createElement(R.a,{sensors:[k],onDragStart:function(e){y(e.active.id),h({x:window.scrollX,y:window.scrollY})},onDragEnd:function(e){var n;if(e.over){var a=e.over.id,r=t.find((function(e){return e.id===a}));n={x:r.x*(u||1),y:r.y*(u||1),column_id:a}}else n={x:e.delta.x+((null===b||void 0===b?void 0:b.x)||0)-p.x,y:e.delta.y+((null===b||void 0===b?void 0:b.y)||0)-p.y,column_id:void 0};l(e.active.id,n),y("")},onDragCancel:function(){return y("")}},r.a.createElement(z,{placements:t,attachments:n,scale:u}),n.map((function(e){return function(e,t){return e.type===I.IMAGE?r.a.createElement(X,Object.assign({key:t,hidden:O===e.id,pageWidth:i.width,pageHeight:i.height,removeImage:function(){return o(e.id)},updateImageAttachment:P(e.id)},e)):r.a.createElement(U,Object.assign({key:t,hidden:O===e.id,pageWidth:i.width,pageHeight:i.height,removeText:function(){return o(e.id)},updateTextAttachment:P(e.id)},e))}(e,e.id)})),Object(c.createPortal)(r.a.createElement(R.b,null,A),document.body))},V=n(16),W=n.n(V);!function(e){e.PDF="pdf",e.IMAGE="image"}(Y||(Y={}));var J=function(e){var t=e.afterUploadPdf,n=e.afterUploadImage,r=e.use,c=Object(a.useState)(!1),i=Object(s.a)(c,2),o=i[0],l=i[1],f=Object(a.createRef)();return{inputRef:f,uploading:o,handleUpload:function(){var e=f.current;e&&(e.value="",l(!0),e.click())},fileOnChange:function(){var e=Object(d.a)(u.a.mark((function e(a){var c,i,s,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=2;break}return e.abrupt("return");case 2:if(c=a.currentTarget.files||a.dataTransfer&&a.dataTransfer.files){e.next=6;break}return l(!1),e.abrupt("return");case 6:if(i=c[0],r!==Y.IMAGE){e.next=14;break}return e.next=10,K(i);case 10:s=e.sent,n&&n(s),e.next=19;break;case 14:if(r!==Y.PDF){e.next=19;break}return e.next=17,q(i);case 17:d=e.sent,t&&t(d);case 19:l(!1);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}};function K(e){return $.apply(this,arguments)}function $(){return($=Object(d.a)(u.a.mark((function e(t){var n,a,r,c,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v(t);case 3:return n=e.sent,e.next=6,b(n);case 6:return a=e.sent,r=W.a.v4(),c=a.width,i=a.height,e.abrupt("return",{id:r,type:I.IMAGE,width:c,height:i,x:0,y:0,img:a,file:t});case 12:throw e.prev=12,e.t0=e.catch(0),console.log("Failed to load image",e.t0),new Error("Failed to load image");case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function q(e){return Q.apply(this,arguments)}function Q(){return(Q=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E(t);case 3:return n=e.sent,e.abrupt("return",{file:t,name:t.name,pages:Array(n.numPages).fill(0).map((function(e,t){return n.getPage(t+1)}))});case 7:throw e.prev=7,e.t0=e.catch(0),console.log("Failed to load pdf",e.t0),new Error("Failed to load PDF");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}var Z=function(e,t,n){var a=1;return e>n&&(a=n/e),t>n&&(a=Math.min(a,n/t)),{width:e*a,height:t*a}},ee=function(e){var t=e.children,n=e.onClick,a=e.style;return r.a.createElement("div",{onClick:n,style:Object(o.a)({margin:"0.5rem",float:"left"},a)},t)},te=function(e){var t=e.attachment,n=e.addAttachment,a=e.scale,c=void 0===a?1:a;return r.a.createElement(ee,{onClick:function(e){n&&n(Object(o.a)(Object(o.a)({},t),{},{id:W.a.v4()}))}},r.a.createElement(L,Object.assign({},function(e){var t=Z(e.width,e.height,80),n=t.width,a=t.height;return Object(o.a)(Object(o.a)({},e),{},{x:e.x*c,y:e.y*c,width:n*c,height:a*c})}(t),{style:{cursor:"pointer"}})))},ne=n(28),ae=Object(ne.a)("MY_DB",10,{upgrade:function(e,t,n,a){e.createObjectStore("imageFiles"),e.createObjectStore("pdfs")},blocked:function(){},blocking:function(){},terminated:function(){}});function re(e,t){return ce.apply(this,arguments)}function ce(){return(ce=Object(d.a)(u.a.mark((function e(t,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae;case 2:return a=e.sent,e.next=5,a.put("imageFiles",t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(){return oe.apply(this,arguments)}function oe(){return(oe=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae;case 2:return t=e.sent,e.next=5,t.getAll("imageFiles");case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(){return le.apply(this,arguments)}function le(){return(le=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae;case 2:return t=e.sent,n=t.transaction(["imageFiles"],"readwrite"),e.next=6,n.objectStore("imageFiles").clear();case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ue=function(){for(var e=[],t=0;t<5;t++)for(var n=0;n<4;n++)e.push({height:50,width:91,x:103+91*t,y:470+50*n,id:"".concat(t,"-").concat(n)});return e},de=function(e){var t=e.page,n=e.dimensions,c=e.setDimensions,i=e.scale,o=void 0===i?1:i,l=Object(a.useRef)(null),f=Object(a.useState)((null===n||void 0===n?void 0:n.width)||0),p=Object(s.a)(f,2),h=p[0],m=p[1],g=Object(a.useState)((null===n||void 0===n?void 0:n.height)||0),b=Object(s.a)(g,2),v=b[0],E=b[1];return Object(a.useEffect)((function(){function e(){return(e=Object(d.a)(u.a.mark((function e(){var n,a,r,i,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(n=e.sent,a=l.current,!n){e.next=14;break}if(r=null===a||void 0===a?void 0:a.getContext("2d"),i=n.getViewport({scale:o}),m(i.width),E(i.height),!r){e.next=14;break}return e.next=12,n.render({canvasContext:null===a||void 0===a?void 0:a.getContext("2d"),viewport:i}).promise;case 12:s={width:i.width,height:i.height},c&&c(s);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,c]),r.a.createElement("div",null,r.a.createElement("canvas",{ref:l,width:h,height:v}))},fe=n(51),pe=function(e){var t=e.currentPage,n=e.dimensions,a=e.setDimensions,c=e.children,i=e.scale;return r.a.createElement(fe.a,{style:{display:"table"}},r.a.createElement(de,{dimensions:n,setDimensions:a,page:t,scale:i}),c)},he=function(e){var t=e.onClick,n=e.children;e.scale;return r.a.createElement(ee,null,r.a.createElement(A.a,{style:{width:"100%",height:"5rem"},onClick:t},n))},me=function(){var e=Object(a.useState)(1.65),t=Object(s.a)(e,2),n=t[0],c=(t[1],function(){var e=Object(a.useState)(""),t=Object(s.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(-1),i=Object(s.a)(c,2),o=i[0],l=i[1],f=Object(a.useState)(),p=Object(s.a)(f,2),h=p[0],m=p[1],g=Object(a.useState)(),b=Object(s.a)(g,2),v=b[0],E=b[1],O=Object(a.useState)([]),y=Object(s.a)(O,2),w=y[0],j=y[1],A=Object(a.useState)(!1),T=Object(s.a)(A,2),k=T[0],P=T[1],C=Object(a.useState)(!1),D=Object(s.a)(C,2),I=D[0],S=D[1],M=Object(a.useState)(!1),F=Object(s.a)(M,2),R=F[0],N=F[1],H=Object(a.useState)(!1),_=Object(s.a)(H,2),U=_[0],L=_[1],X=Object(a.useCallback)(m,[m]);return{isMultiPage:k,isFirstPage:I,isLastPage:R,isSaving:U,currentPage:w[o],dimensions:h,setDimensions:X,name:n,setName:r,pageIndex:o,setPageIndex:l,file:v,setFile:E,pages:w,nextPage:function(){var e=o+1;l(o+1),S(0===e),N(e===w.length-1)},savePdf:function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!U&&v){e.next=2;break}return e.abrupt("return");case 2:return L(!0),e.prev=3,e.next=6,x(v,t,n);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),console.log(e.t0);case 11:return e.prev=11,L(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[3,8,11,14]])})));return function(t){return e.apply(this,arguments)}}(),setPdf:function(e){var t=e.name,n=e.file,a=e.pages,c=a.length>1;r(t),E(n),j(a),l(0),P(c),S(!0),N(1===a.length)},previousPage:function(){var e=o-1;l(e),S(0===e),N(e===w.length-1)}}}()),i=c.file,l=c.setPdf,f=c.pageIndex,p=c.isMultiPage,h=c.isFirstPage,m=c.isLastPage,g=c.currentPage,b=(c.isSaving,c.savePdf),v=c.previousPage,E=c.nextPage,O=c.setDimensions,P=(c.name,c.dimensions),C=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(!1),i=Object(s.a)(c,2),o=i[0],l=i[1];Object(a.useEffect)((function(){function e(){return(e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie();case 2:return t=e.sent,e.next=5,Promise.all(t.map(function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:n=e.sent,r(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return e.apply(this,arguments)})().then()}),[o]);var f=function(){return l(!o)};return{allCandidates:n,saveImage:function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re(t.file,t.id);case 2:f();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),removeAllImages:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se();case 2:f();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}(),D=C.saveImage,S=C.allCandidates,R=C.removeAllImages,N=function(){var e=Object(a.useReducer)(F,M),t=Object(s.a)(e,2),n=t[0],r=t[1],c=n.allPageAttachments;return{pageAttachments:n.pageAttachments,allPageAttachments:c,addAttachment:function(e){return r({type:y.ADD_ATTACHMENT,attachment:e})},resetAttachments:function(e){return r({type:y.RESET,numberOfPages:e})},removeAttachments:function(e){return r({type:y.REMOVE_ATTACHMENT,id:e})},updateAttachments:function(e,t){return r({type:y.UPDATE_ATTACHMENT,id:e,attachment:t})},setPageIndex:Object(a.useCallback)((function(e){return r({type:y.UPDATE_PAGE_INDEX,pageIndex:e})}),[r])}}(),H=N.addAttachment,U=N.allPageAttachments,L=N.pageAttachments,X=N.resetAttachments,G=N.updateAttachments,z=N.removeAttachments,V=N.setPageIndex,$=!!i,q=J({use:Y.PDF,afterUploadPdf:function(e){l(e);var t=e.pages.length;X(t)}}),Q=q.inputRef,ee=q.handleUpload,ne=q.fileOnChange,ae=J({use:Y.IMAGE,afterUploadImage:function(e){D(e).then(),de(e)}}),ce=ae.inputRef,oe=ae.handleUpload,le=ae.fileOnChange;Object(a.useEffect)((function(){return V(f)}),[f,V]);var de=function(e){H(function(e){e.type===I.TEXT?e=function(e){return Object(o.a)(Object(o.a)({},e),{},{x:e.x*n,y:e.y*n,width:e.width*n,height:e.height*n,size:e.size?e.size*n:void 0})}(e):e.type===I.IMAGE&&(e=function(e){var t=Z(e.width,e.height,80),a=t.width,r=t.height;return Object(o.a)(Object(o.a)({},e),{},{x:e.x*n,y:e.y*n,width:a*n,height:r*n})}(e));return e}(e))};var fe=r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{ref:Q,type:"file",accept:"application/pdf",onChange:ne,style:{display:"none"}}),r.a.createElement("input",{ref:ce,type:"file",accept:"image/*",style:{display:"none"},onChange:le})),me={};p&&!h||(me={visibility:"hidden"});var ge={};return p&&!m||(ge={visibility:"hidden"}),r.a.createElement("div",{className:"App"},fe,r.a.createElement(w.a,{fluid:!0},r.a.createElement("div",{style:{marginTop:"10px"}},!$&&r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{className:"justify-content-center mt-lg-5"},r.a.createElement("div",null,r.a.createElement("h3",null,"\u4e0a\u50b3\u4e00\u4efd Pdf\uff01"),r.a.createElement(A.a,{onClick:ee},r.a.createElement(_.f,null)," Upload")))),r.a.createElement(j.a,null,r.a.createElement(T.a,{sm:3},$&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"\u52a0\u5165\u9644\u4ef6"),r.a.createElement("p",null,"\u9019\u4e9b\u5716\u7247\u88ab\u5132\u5b58\u5728 local \u7684 IndexedDB\u3002",r.a.createElement(A.a,{variant:"link",onClick:R},"\u6e05\u7a7a\u5716\u7247")),r.a.createElement(he,{scale:n,onClick:function(){var e={id:W.a.v4(),type:I.TEXT,x:0,y:0,width:120,height:25,size:16,lineHeight:1.4,fontFamily:"Times-Roman",text:"Enter Text Here"};de(e)}},"\u65b0\u589e\u6587\u5b57"),S.filter((function(e){return e.type===I.IMAGE})).map((function(e){return r.a.createElement(te,{key:e.id,attachment:e,addAttachment:de,scale:n})})),r.a.createElement(he,{scale:n,onClick:oe},"\u4e0a\u50b3\u5716\u7247"))),r.a.createElement(T.a,{sm:9},r.a.createElement("div",{className:"pt-2 pb-2 d-flex justify-content-between",style:{width:(null===P||void 0===P?void 0:P.width)||0}},r.a.createElement("div",null,r.a.createElement(A.a,{style:me,className:"rounded-circle",variant:"outline-dark",onClick:v},r.a.createElement(_.a,null))),r.a.createElement("div",null,$&&r.a.createElement(k.a,{className:"justify-content-center"},r.a.createElement(k.a.Link,{onClick:ee},r.a.createElement(_.f,null)," Upload New"),r.a.createElement(k.a.Link,{onClick:function(){return b(U.map((function(e){return e.map((function(e){return(t=e).type===I.TEXT?t=function(e){return Object(o.a)(Object(o.a)({},e),{},{x:e.x/n,y:e.y/n,width:e.width/n,height:e.height/n,size:e.size?e.size/n:void 0})}(t):t.type===I.IMAGE&&(t=function(e){return Object(o.a)(Object(o.a)({},e),{},{x:e.x/n,y:e.y/n,width:e.width/n,height:e.height/n})}(t)),t;var t}))})))}},r.a.createElement(_.e,null)," Save "))),r.a.createElement("div",null,r.a.createElement(A.a,{style:ge,className:"rounded-circle",variant:"outline-dark",onClick:E},r.a.createElement(_.b,null)))),g&&r.a.createElement(pe,{currentPage:g,dimensions:P,setDimensions:O,scale:n},P&&r.a.createElement(B,{removeAttachment:z,updateAttachment:G,pageDimensions:P,attachments:L,placements:ue(),scale:n})))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));f.forEach((function(e){var t=e.name,n=e.src;p[t]=new Promise((function(e,a){var r=document.createElement("script");r.src=n,r.onload=function(){e(window[t]),console.log("".concat(t," is loaded."))},r.onerror=function(){return a("The script ".concat(t," didn't load correctly."))},document.body.appendChild(r)}))})),i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(me,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[30,1,2]]]);
//# sourceMappingURL=main.31e69956.chunk.js.map