(this["webpackJsonppdf-editor"]=this["webpackJsonppdf-editor"]||[]).push([[0],{32:function(e,t,n){e.exports=n(47)},37:function(e,t,n){},38:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(10),c=n.n(i),o=(n(37),n(2)),s=(n(38),n(3)),l=n.n(s),u=n(5),d=n(1),f=[{name:"pdfjsLib",src:"https://unpkg.com/pdfjs-dist@2.3.200/build/pdf.min.js"},{name:"PDFLib",src:"https://unpkg.com/pdf-lib@1.4.0/dist/pdf-lib.min.js"},{name:"download",src:"https://unpkg.com/downloadjs@1.4.7"},{name:"w3Color",src:"https://www.w3schools.com/lib/w3color.js"}],p={},h=function(e){return p[e]},m={Courier:{correction:function(e,t){return(e*t-e)/2+e/6}},Helvetica:{correction:function(e,t){return(e*t-e)/2+e/10}},"Times-Roman":{correction:function(e,t){return(e*t-e)/2+e/7}}},g=(Object(d.a)(Object(d.a)({},m),{},{"\u6a19\u6977\u9ad4":{src:"/CK.ttf",correction:function(e,t){return(e*t-e)/2}}}),function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(){return t(a.result)},a.onerror=n,a.readAsArrayBuffer(e)}))}),b=function(e){return new Promise((function(t,n){var a=new Image;if(a.onload=function(){return t(a)},a.onerror=n,e instanceof Blob){var r=window.URL.createObjectURL(e);a.src=r}else a.src=e}))},v=function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(){return t(a.result)},a.onerror=n,a.readAsDataURL(e)}))},E=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("pdfjsLib");case 2:return n=e.sent,a=new Blob([t]),r=window.URL.createObjectURL(a),e.abrupt("return",n.getDocument(r).promise);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function x(e,t,n){return w.apply(this,arguments)}function w(){return(w=Object(u.a)(l.a.mark((function e(t,n,a){var r,i,c,o,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("PDFLib");case 2:return r=e.sent,e.next=5,h("download");case 5:return i=e.sent,e.prev=6,e.t0=r.PDFDocument,e.next=10,g(t);case 10:return e.t1=e.sent,e.next=13,e.t0.load.call(e.t0,e.t1);case 13:c=e.sent,e.next=20;break;case 16:throw e.prev=16,e.t2=e.catch(6),console.log("Failed to load PDF."),e.t2;case 20:return o=c.getPages().map(function(){var e=Object(u.a)(l.a.mark((function e(t,a){var r,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n[a],i=t.getHeight(),o=r.map(function(){var e=Object(u.a)(l.a.mark((function e(n){var a,r,o,s,u,d,f,p,h,m,b,v,E,x,w,O;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("image"!==n.type){e.next=29;break}if(r=(a=n).file,o=a.x,s=a.y,u=a.width,d=a.height,e.prev=2,"image/jpeg"!==r.type){e.next=13;break}return e.t0=c,e.next=7,g(r);case 7:return e.t1=e.sent,e.next=10,e.t0.embedJpg.call(e.t0,e.t1);case 10:f=e.sent,e.next=20;break;case 13:return e.t2=c,e.next=16,g(r);case 16:return e.t3=e.sent,e.next=19,e.t2.embedPng.call(e.t2,e.t3);case 19:f=e.sent;case 20:return e.abrupt("return",(function(){return t.drawImage(f,{x:o,y:i-s-d,width:u,height:d})}));case 23:throw e.prev=23,e.t4=e.catch(2),console.log("Failed to embed image.",e.t4),e.t4;case 27:e.next=35;break;case 29:if("text"!==n.type){e.next=35;break}return h=(p=n).x,m=p.y,b=p.text,v=p.lineHeight,E=p.size,x=p.fontFamily,w=p.width,e.next=33,c.embedFont(x);case 33:return O=e.sent,e.abrupt("return",(function(){return t.drawText(b,{maxWidth:w,font:O,size:E,lineHeight:v,x:h,y:i-E-m})}));case 35:case"end":return e.stop()}}),e,null,[[2,23]])})));return function(t){return e.apply(this,arguments)}}()),e.next=5,Promise.all(o);case 5:e.sent.forEach((function(e){return e()}));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=23,Promise.all(o);case 23:return e.prev=23,e.next=26,c.save();case 26:s=e.sent,i(s,a,"application/pdf"),e.next=34;break;case 30:throw e.prev=30,e.t3=e.catch(23),console.log("Failed to save PDF."),e.t3;case 34:case"end":return e.stop()}}),e,null,[[6,16],[23,30]])})))).apply(this,arguments)}var O,y=n(49),j=n(50),A=n(48),k=n(51),T=n(52),P=(n(40),n(11));!function(e){e.RESET="RESET",e.ADD_ATTACHMENT="ADD_ATTACHMENT",e.REMOVE_ATTACHMENT="REMOVE_ATTACHMENT",e.UPDATE_ATTACHMENT="UPDATE_ATTACHMENT",e.UPDATE_PAGE_INDEX="UPDATE_PAGE_INDEX"}(O||(O={}));var C,D,I,S,M={pageIndex:-1,allPageAttachments:[],pageAttachments:[]},R=function(e,t){var n=e.pageIndex,a=e.allPageAttachments,r=e.pageAttachments;switch(t.type){case O.ADD_ATTACHMENT:var i=a.map((function(e,a){return n===a?[].concat(Object(P.a)(e),[t.attachment]):e}));return Object(d.a)(Object(d.a)({},e),{},{allPageAttachments:i,pageAttachments:i[n]});case O.REMOVE_ATTACHMENT:var c=a.map((function(e,a){return n===a?r.filter((function(e){return e.id!==t.id})):e}));return Object(d.a)(Object(d.a)({},e),{},{allPageAttachments:c,pageAttachments:c[n]});case O.UPDATE_ATTACHMENT:if(-1===n)return e;var o=a.map((function(e,a){return n===a?r.map((function(e){return e.id===t.id?Object(d.a)(Object(d.a)({},e),t.attachment):e})):e}));return Object(d.a)(Object(d.a)({},e),{},{allPageAttachments:o,pageAttachments:o[n]});case O.UPDATE_PAGE_INDEX:return Object(d.a)(Object(d.a)({},e),{},{pageIndex:t.pageIndex,pageAttachments:a[t.pageIndex]});case O.RESET:return{pageIndex:0,pageAttachments:[],allPageAttachments:Array(t.numberOfPages).fill([])};default:return e}};!function(e){e.MOVE="MOVE",e.SCALE="SCALE",e.NO_MOVEMENT="NO_MOVEMENT"}(C||(C={})),function(e){e.RED="red",e.ORANGE="orange",e.YELLOW="yellow",e.OLIVE="olive",e.GREEN="green",e.TEAL="teal",e.BLUE="blue",e.VIOLOET="violet",e.PURPLE="purple",e.BROWN="brown",e.GREY="grey",e.BLACK="black"}(D||(D={})),function(e){e.IMAGE="image",e.TEXT="text"}(I||(I={})),function(e){e.INSERT="insert",e.COMMAND="command"}(S||(S={}));var F=n(9),N=Object(a.forwardRef)((function(e,t){var n=e.listeners,a=e.draggableAttrs,i=e.onBlur,c=e.onChangeText,o=e.editing,s=void 0!==o&&o,l=e.text,u=e.size,f=e.lineHeight,p=e.fontFamily,h=e.style,m=Object(d.a)(Object(d.a)({},n),a);return r.a.createElement("input",Object.assign({type:"text",onBlur:i,ref:t,onChange:c,readOnly:!s,style:Object(d.a)({fontSize:u,lineHeight:f,fontFamily:p,outline:"none",padding:0,margin:0,cursor:s?"text":"move",border:"unset",backgroundColor:"unset"},h),value:l,size:(null===l||void 0===l?void 0:l.length)||5},s?{}:m))})),H=function(e){var t=e.style,n=e.translateX,a=e.translateY,i=e.position,c=e.children;return r.a.createElement("div",{style:Object(d.a)(Object(d.a)({position:"absolute"},i),{},{width:"3rem",height:"3rem",margin:"auto",borderRadius:"9999px",transform:"translateX(".concat(n,") translateY(").concat(a,") rotate(0) skewX(0) skewY(0) scaleX(0.25) scaleY(0.25)")},t)},c)},_=n(19),U=function(e){var t=e.id,n=e.text,i=(e.pageHeight,e.pageWidth,e.removeText),c=e.updateTextAttachment,s=e.size,l=e.lineHeight,u=e.fontFamily,f=e.hidden,p=void 0!==f&&f,h=e.x,m=e.y,g=Object(a.useState)(n||""),b=Object(o.a)(g,2),v=b[0],E=b[1],x=Object(a.useState)(!1),w=Object(o.a)(x,2),O=w[0],y=w[1],j=Object(F.e)({id:t}),A=j.attributes,k=j.node,T=(j.isDragging,j.listeners),P=j.setNodeRef;Object(a.useEffect)((function(){if(O){var e=k.current;e&&(e.focus(),e.select())}else{var t;if(null===(t=document.getSelection())||void 0===t||t.removeAllRanges(),""===v&&i)i();else if(c){c({lines:[v],text:v})}}}),[O]);var C=function(){y(!1)},D=r.a.createElement(H,{position:{left:0,top:0,right:0},translateX:"0",translateY:"-50%",style:{backgroundColor:"white"}},r.a.createElement(_.c,{onClick:C,style:{cursor:"pointer",color:"#1eb99d",width:"100%",height:"100%"}})),I=r.a.createElement(H,{position:{left:0,top:0,right:0},translateX:"0",translateY:"-50%",style:{backgroundColor:"white"}},r.a.createElement(_.g,{onClick:i,style:{cursor:"pointer",color:"rgb(245, 101, 101)",width:"100%",height:"100%"}})),S={borderWidth:"0.3px",borderColor:"gray",borderStyle:O?"solid":"dashed"},M=p?{visibility:"hidden"}:{};return r.a.createElement("div",{style:Object(d.a)({position:"absolute",left:"".concat(null!==h&&void 0!==h?h:0,"px"),top:"".concat(null!==m&&void 0!==m?m:0,"px")},M),onDoubleClick:function(){y(!0)}},O?D:I,r.a.createElement(N,{ref:P,listeners:T,draggableAttrs:A,onBlur:C,text:v,size:s,lineHeight:l,fontFamily:u,editing:O,onChangeText:function(e){var t=e.currentTarget.value;E(t)},style:S}))},L=Object(a.forwardRef)((function(e,t){var n=e.width,a=e.height,i=e.img,c=e.style,o=e.listeners,s=e.draggableAttrs,l=e.desc;return r.a.createElement("img",Object.assign({style:Object(d.a)({width:n||"100%",height:a||"100%",cursor:"move"},c),src:i.src,ref:t},o,s,{alt:l}))})),X=n(29),G=function(e){var t=e.id,n=e.img,a=e.width,i=e.height,c=(e.pageWidth,e.removeImage),o=(e.pageHeight,e.hidden),s=void 0!==o&&o,l=e.x,u=e.y,f=e.resizeImage,p=Object(F.e)({id:t}),h=p.attributes,m=(p.isDragging,p.listeners),g=p.setNodeRef,b=r.a.createElement(H,{position:{left:0,top:0,right:0},translateX:"0",translateY:"-50%",style:{backgroundColor:"white"}},r.a.createElement(_.g,{onClick:c,style:{cursor:"pointer",color:"rgb(245, 101, 101)",width:"100%",height:"100%"}})),v=r.a.createElement(_.d,{style:{color:"#90cdf4",width:"100%",height:"100%"}}),E=r.a.createElement(H,{position:{left:0,top:0},translateX:"-50%",translateY:"-50%"},v),x=r.a.createElement(H,{position:{right:0,top:0},translateX:"50%",translateY:"-50%"},v),w=r.a.createElement(H,{position:{left:0,bottom:0},translateX:"-50%",translateY:"50%"},v),O=r.a.createElement(H,{position:{right:0,bottom:0},translateX:"50%",translateY:"50%"},v),y=s?{visibility:"hidden"}:{};return r.a.createElement("div",{style:Object(d.a)({position:"absolute",left:"".concat(null!==l&&void 0!==l?l:0,"px"),top:"".concat(null!==u&&void 0!==u?u:0,"px")},y)},r.a.createElement(X.a,{size:{width:a,height:i},onResizeStop:function(e,t,n,a){function r(e){var t=e.replace("px",""),n=parseInt(t);if(n)return n;throw new Error(e+" can't parse to int: "+n+"when parse "+t)}f&&f(r(n.style.width),r(n.style.height))}},E,x,w,O,r.a.createElement(L,{ref:g,listeners:m,draggableAttrs:h,style:{border:"0.3px dashed gray",cursor:"move"},img:n})),c&&b)};function z(e){var t=e.children,n=e.id,a=e.x,i=e.y,c=e.width,o=e.height,s=Object(F.f)({id:n}),l=s.isOver,u=s.setNodeRef,f={color:"gray",borderStyle:"dashed",borderWidth:"1px"};return l&&(f={boxShadow:"inset #1eb99d 0 0 0 3px, rgba(201, 211, 219, 0.5) 20px 14px 24px"}),t&&(f={color:"rgb(245, 101, 101)",borderStyle:"solid"}),r.a.createElement("div",{ref:u,style:Object(d.a)({width:c,height:o,position:"absolute",left:"".concat(null!==a&&void 0!==a?a:0,"px"),top:"".concat(null!==i&&void 0!==i?i:0,"px")},f)},t)}var Y,B=function(e){var t=e.placements,n=e.attachments;return r.a.createElement(r.a.Fragment,null,t.map((function(e){var t=e.id;return r.a.createElement(z,Object.assign({key:t},e),function(e){var t=e.map((function(e){var t=e.id;return r.a.createElement("div",{hidden:!0,key:t})}));return t.length?t:null}(null===n||void 0===n?void 0:n.filter((function(e){return e.column_id===t}))))})))},V=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n,r=1;e>n&&(r=n/e),t>a&&(r=Math.min(r,a/t));var i=e*r,c=t*r;return{width:i,height:c}},W=function(e){var t=e.placements,n=e.attachments,c=e.pageDimensions,s=e.removeAttachment,l=e.updateAttachment,u=e.scale,f=void 0===u?1:u,p=Object(a.useState)(F.d),h=Object(o.a)(p,2),m=h[0],g=h[1],b=Object(a.useState)(null),v=Object(o.a)(b,2),E=v[0],x=v[1],w=n.map((function(e){return function(e){e.type===I.TEXT?e=function(e){return Object(d.a)(Object(d.a)({},e),{},{x:e.x*f,y:e.y*f,width:e.width*f,height:e.height*f,size:e.size?e.size*f:void 0})}(e):e.type===I.IMAGE&&(e=function(e){var t=e.width,n=e.height;return Object(d.a)(Object(d.a)({},e),{},{x:e.x*f,y:e.y*f,width:t*f,height:n*f})}(e));return e}(e)})),O=t.map((function(e){return Object(d.a)(Object(d.a)({},e),{},{width:e.width*f,height:e.height*f,x:e.x*f,y:e.y*f})})),y=Object(F.g)(F.c,{activationConstraint:{distance:1}}),j=null;if(E){var A=w.find((function(e){return e.id===E}));A.type===I.TEXT?j=r.a.createElement(N,A):A.type===I.IMAGE&&(j=r.a.createElement(L,A))}else j=null;var k=function(e){return function(t){return l(e,t)}};function T(e,t){return e.type===I.IMAGE?r.a.createElement(G,Object.assign({key:t,hidden:E===e.id,pageWidth:c.width,pageHeight:c.height,removeImage:function(){return s(e.id)},resizeImage:function(t,n){return a=t,r=n,i=e.id,void k(i)({width:a/f,height:r/f});var a,r,i}},e)):r.a.createElement(U,Object.assign({key:t,hidden:E===e.id,pageWidth:c.width,pageHeight:c.height,removeText:function(){return s(e.id)},updateTextAttachment:k(e.id)},e))}return r.a.createElement(F.a,{sensors:[y],onDragStart:function(e){x(e.active.id),g({x:window.scrollX,y:window.scrollY})},onDragEnd:function(e){var a,r=n.find((function(e){return e.id===E}));if(e.over){var i=e.over.id,c=t.find((function(e){return e.id===i})),o=V(r.width,r.height,c.width,c.height),s=o.width,l=o.height;a={x:c.x,y:c.y,column_id:i,width:s,height:l}}else a={x:e.delta.x/f+(r.x||0)-m.x/f,y:e.delta.y/f+(r.y||0)-m.y/f,column_id:void 0};k(e.active.id)(a),x(null)},onDragCancel:function(){return x(null)}},r.a.createElement(B,{placements:O,attachments:n}),w.map((function(e){return T(e,e.id)})),Object(i.createPortal)(r.a.createElement(F.b,null,j),document.body))},J=n(17),K=n.n(J);!function(e){e.PDF="pdf",e.IMAGE="image"}(Y||(Y={}));var $=function(e){var t=e.afterUploadPdf,n=e.afterUploadImage,r=e.use,i=Object(a.useState)(!1),c=Object(o.a)(i,2),s=c[0],d=c[1],f=Object(a.createRef)();return{inputRef:f,uploading:s,handleUpload:function(){var e=f.current;e&&(e.value="",d(!0),e.click())},fileOnChange:function(){var e=Object(u.a)(l.a.mark((function e(a){var i,c,o,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:if(i=a.currentTarget.files||a.dataTransfer&&a.dataTransfer.files){e.next=6;break}return d(!1),e.abrupt("return");case 6:if(c=i[0],r!==Y.IMAGE){e.next=14;break}return e.next=10,q(c);case 10:o=e.sent,n&&n(o),e.next=19;break;case 14:if(r!==Y.PDF){e.next=19;break}return e.next=17,Z(c);case 17:u=e.sent,t&&t(u);case 19:d(!1);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}};function q(e){return Q.apply(this,arguments)}function Q(){return(Q=Object(u.a)(l.a.mark((function e(t){var n,a,r,i,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v(t);case 3:return n=e.sent,e.next=6,b(n);case 6:return a=e.sent,r=K.a.v4(),i=a.width,c=a.height,e.abrupt("return",{id:r,type:I.IMAGE,width:i,height:c,x:0,y:0,img:a,file:t});case 12:throw e.prev=12,e.t0=e.catch(0),console.log("Failed to load image",e.t0),new Error("Failed to load image");case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function Z(e){return ee.apply(this,arguments)}function ee(){return(ee=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E(t);case 3:return n=e.sent,e.abrupt("return",{file:t,name:t.name,pages:Array(n.numPages).fill(0).map((function(e,t){return n.getPage(t+1)}))});case 7:throw e.prev=7,e.t0=e.catch(0),console.log("Failed to load pdf",e.t0),new Error("Failed to load PDF");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}var te=function(e){var t=e.children,n=e.onClick,a=e.style;return r.a.createElement("div",{onClick:n,style:Object(d.a)({margin:"0.5rem",float:"left"},a)},t)},ne=function(e){var t=e.attachment,n=e.addAttachment,a=e.scale,i=void 0===a?1:a;return r.a.createElement(te,{onClick:function(e){n&&n(Object(d.a)(Object(d.a)({},t),{},{id:K.a.v4()}))}},r.a.createElement(L,Object.assign({},function(e){var t=V(e.width,e.height,90),n=t.width,a=t.height;return Object(d.a)(Object(d.a)({},e),{},{x:e.x*i,y:e.y*i,width:n*i,height:a*i})}(t),{style:{cursor:"pointer"}})))},ae=n(30),re=Object(ae.a)("MY_DB",10,{upgrade:function(e,t,n,a){e.createObjectStore("imageFiles"),e.createObjectStore("pdfs")},blocked:function(){},blocking:function(){},terminated:function(){}});function ie(e,t){return ce.apply(this,arguments)}function ce(){return(ce=Object(u.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re;case 2:return a=e.sent,e.next=5,a.put("imageFiles",t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(){return se.apply(this,arguments)}function se(){return(se=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re;case 2:return t=e.sent,e.next=5,t.getAll("imageFiles");case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(){return ue.apply(this,arguments)}function ue(){return(ue=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re;case 2:return t=e.sent,n=t.transaction(["imageFiles"],"readwrite"),e.next=6,n.objectStore("imageFiles").clear();case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var de=function(){for(var e=[],t=0;t<5;t++)for(var n=0;n<4;n++)e.push({height:50,width:91,x:103+91*t,y:470+50*n,id:"".concat(t,"-").concat(n)});return e},fe=function(e){var t=e.page,n=e.dimensions,i=e.setDimensions,c=e.scale,s=void 0===c?1:c,d=Object(a.useRef)(null),f=Object(a.useState)((null===n||void 0===n?void 0:n.width)||0),p=Object(o.a)(f,2),h=p[0],m=p[1],g=Object(a.useState)((null===n||void 0===n?void 0:n.height)||0),b=Object(o.a)(g,2),v=b[0],E=b[1];return Object(a.useEffect)((function(){function e(){return(e=Object(u.a)(l.a.mark((function e(){var n,a,r,c,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(n=e.sent,a=d.current,!n){e.next=14;break}if(r=null===a||void 0===a?void 0:a.getContext("2d"),c=n.getViewport({scale:s}),m(c.width),E(c.height),!r){e.next=14;break}return e.next=12,n.render({canvasContext:null===a||void 0===a?void 0:a.getContext("2d"),viewport:c}).promise;case 12:o={width:c.width,height:c.height},i&&i(o);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,i]),r.a.createElement("div",null,r.a.createElement("canvas",{ref:d,width:h,height:v}))},pe=n(53),he=function(e){var t=e.currentPage,n=e.dimensions,a=e.setDimensions,i=e.children,c=e.scale;return r.a.createElement(pe.a,{style:{display:"table"}},r.a.createElement(fe,{dimensions:n,setDimensions:a,page:t,scale:c}),i)},me=function(e){var t=e.onClick,n=e.children;e.scale;return r.a.createElement(te,null,r.a.createElement(A.a,{style:{width:"100%",height:"5rem"},onClick:t},n))},ge=function(){var e=Object(a.useState)(1.65),t=Object(o.a)(e,2),n=t[0],i=(t[1],function(){var e=Object(a.useState)(""),t=Object(o.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(-1),c=Object(o.a)(i,2),s=c[0],d=c[1],f=Object(a.useState)(),p=Object(o.a)(f,2),h=p[0],m=p[1],g=Object(a.useState)(),b=Object(o.a)(g,2),v=b[0],E=b[1],w=Object(a.useState)([]),O=Object(o.a)(w,2),y=O[0],j=O[1],A=Object(a.useState)(!1),k=Object(o.a)(A,2),T=k[0],P=k[1],C=Object(a.useState)(!1),D=Object(o.a)(C,2),I=D[0],S=D[1],M=Object(a.useState)(!1),R=Object(o.a)(M,2),F=R[0],N=R[1],H=Object(a.useState)(!1),_=Object(o.a)(H,2),U=_[0],L=_[1],X=Object(a.useCallback)(m,[m]);return{isMultiPage:T,isFirstPage:I,isLastPage:F,isSaving:U,currentPage:y[s],dimensions:h,setDimensions:X,name:n,setName:r,pageIndex:s,setPageIndex:d,file:v,setFile:E,pages:y,nextPage:function(){var e=s+1;d(s+1),S(0===e),N(e===y.length-1)},savePdf:function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!U&&v){e.next=2;break}return e.abrupt("return");case 2:return L(!0),e.prev=3,e.next=6,x(v,t,n);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),console.log(e.t0);case 11:return e.prev=11,L(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[3,8,11,14]])})));return function(t){return e.apply(this,arguments)}}(),setPdf:function(e){var t=e.name,n=e.file,a=e.pages,i=a.length>1;r(t),E(n),j(a),d(0),P(i),S(!0),N(1===a.length)},previousPage:function(){var e=s-1;d(e),S(0===e),N(e===y.length-1)}}}()),c=i.file,s=i.setPdf,d=i.pageIndex,f=i.isMultiPage,p=i.isFirstPage,h=i.isLastPage,m=i.currentPage,g=(i.isSaving,i.savePdf),b=i.previousPage,v=i.nextPage,E=i.setDimensions,w=(i.name,i.dimensions),P=function(){var e=Object(a.useState)([]),t=Object(o.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(!1),c=Object(o.a)(i,2),s=c[0],d=c[1];Object(a.useEffect)((function(){function e(){return(e=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe();case 2:return t=e.sent,e.next=5,Promise.all(t.map(function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:n=e.sent,r(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return e.apply(this,arguments)})().then()}),[s]);var f=function(){return d(!s)};return{allCandidates:n,saveImage:function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie(t.file,t.id);case 2:f();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),removeAllImages:function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le();case 2:f();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}(),C=P.saveImage,D=P.allCandidates,S=P.removeAllImages,F=function(){var e=Object(a.useReducer)(R,M),t=Object(o.a)(e,2),n=t[0],r=t[1],i=n.allPageAttachments;return{pageAttachments:n.pageAttachments,allPageAttachments:i,addAttachment:function(e){return r({type:O.ADD_ATTACHMENT,attachment:e})},resetAttachments:function(e){return r({type:O.RESET,numberOfPages:e})},removeAttachments:function(e){return r({type:O.REMOVE_ATTACHMENT,id:e})},updateAttachments:function(e,t){return r({type:O.UPDATE_ATTACHMENT,id:e,attachment:t})},setPageIndex:Object(a.useCallback)((function(e){return r({type:O.UPDATE_PAGE_INDEX,pageIndex:e})}),[r])}}(),N=F.addAttachment,H=F.allPageAttachments,U=F.pageAttachments,L=F.resetAttachments,X=F.updateAttachments,G=F.removeAttachments,z=F.setPageIndex,B=!!c,V=$({use:Y.PDF,afterUploadPdf:function(e){s(e);var t=e.pages.length;L(t)}}),J=V.inputRef,Q=V.handleUpload,Z=V.fileOnChange,ee=$({use:Y.IMAGE,afterUploadImage:function(e){C(e).then(),N(e)}}),te=ee.inputRef,ae=ee.handleUpload,re=ee.fileOnChange;Object(a.useEffect)((function(){return z(d)}),[d,z]);var ce=r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{ref:J,type:"file",accept:"application/pdf",onChange:Z,style:{display:"none"}}),r.a.createElement("input",{ref:te,type:"file",accept:"image/*",style:{display:"none"},onChange:re})),se={};f&&!p||(se={visibility:"hidden"});var ue={};return f&&!h||(ue={visibility:"hidden"}),r.a.createElement("div",{className:"App"},ce,r.a.createElement(y.a,{fluid:!0},r.a.createElement("div",{style:{marginTop:"10px"}},!B&&r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{className:"justify-content-center mt-lg-5"},r.a.createElement("div",null,r.a.createElement("h3",null,"\u4e0a\u50b3\u4e00\u4efd Pdf\uff01"),r.a.createElement(A.a,{onClick:Q},r.a.createElement(_.f,null)," Upload")))),r.a.createElement(j.a,null,r.a.createElement(k.a,{sm:3},B&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"\u52a0\u5165\u9644\u4ef6"),r.a.createElement("p",null,"\u9019\u4e9b\u5716\u7247\u88ab\u5132\u5b58\u5728 local \u7684 IndexedDB\u3002",r.a.createElement(A.a,{variant:"link",onClick:S},"\u6e05\u7a7a\u5716\u7247")),r.a.createElement(me,{scale:n,onClick:function(){var e={id:K.a.v4(),type:I.TEXT,x:0,y:0,width:120,height:25,size:16,lineHeight:1.4,fontFamily:"Times-Roman",text:"Enter Text Here"};N(e)}},"\u65b0\u589e\u6587\u5b57"),D.filter((function(e){return e.type===I.IMAGE})).map((function(e){return r.a.createElement(ne,{key:e.id,attachment:e,addAttachment:N,scale:n})})),r.a.createElement(me,{scale:n,onClick:ae},"\u4e0a\u50b3\u5716\u7247"))),r.a.createElement(k.a,{sm:9},r.a.createElement("div",{className:"pt-2 pb-2 d-flex justify-content-between",style:{width:(null===w||void 0===w?void 0:w.width)||0}},r.a.createElement("div",null,r.a.createElement(A.a,{style:se,className:"rounded-circle",variant:"outline-dark",onClick:b},r.a.createElement(_.a,null))),r.a.createElement("div",null,B&&r.a.createElement(T.a,{className:"justify-content-center"},r.a.createElement(T.a.Link,{onClick:Q},r.a.createElement(_.f,null)," Upload New"),r.a.createElement(T.a.Link,{onClick:function(){return g(H)}},r.a.createElement(_.e,null)," Save "))),r.a.createElement("div",null,r.a.createElement(A.a,{style:ue,className:"rounded-circle",variant:"outline-dark",onClick:v},r.a.createElement(_.b,null)))),m&&r.a.createElement(he,{currentPage:m,dimensions:w,setDimensions:E,scale:n},w&&r.a.createElement(W,{removeAttachment:G,updateAttachment:X,pageDimensions:w,attachments:U,placements:de(),scale:n})))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));f.forEach((function(e){var t=e.name,n=e.src;p[t]=new Promise((function(e,a){var r=document.createElement("script");r.src=n,r.onload=function(){e(window[t]),console.log("".concat(t," is loaded."))},r.onerror=function(){return a("The script ".concat(t," didn't load correctly."))},document.body.appendChild(r)}))})),c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ge,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[32,1,2]]]);
//# sourceMappingURL=main.35c2b9bc.chunk.js.map